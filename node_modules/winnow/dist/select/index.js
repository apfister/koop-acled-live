var aggregates = require('./aggregates')
var createGeometryClause = require('./geometry').createClause
var createFieldsClause = require('./fields').createClause

function createClause (options) {
  if (options.aggregates) { return aggregates(options.aggregates, options.groupBy, options.esri) }
  var geometryClause = createGeometryClause(options)
  var fieldsClause = createFieldsClause(options)

  return ("SELECT " + fieldsClause + ", " + geometryClause + " FROM ?")
}

module.exports = { createClause: createClause }
